<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.1">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.1" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.1',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: false,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="大家好，我是牛河">
<meta property="og:type" content="website">
<meta property="og:title" content="smniuhe">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="smniuhe">
<meta property="og:description" content="大家好，我是牛河">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="smniuhe">
<meta name="twitter:description" content="大家好，我是牛河">





  
  
  <link rel="canonical" href="http://yoursite.com/page/4/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>smniuhe</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">smniuhe</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">春风十里，不如你...</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-schedule">

    
    
    
      
    

    

    <a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>Schedule</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  
    

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/19/dubbo-启动服务器提供者，ip-绑定错乱/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/19/dubbo-启动服务器提供者，ip-绑定错乱/" class="post-title-link" itemprop="url">dubbo 启动服务器提供者，ip 绑定错乱</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-19 00:46:56" itemprop="dateCreated datePublished" datetime="2018-02-19T00:46:56+08:00">2018-02-19</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:12:40" itemprop="dateModified" datetime="2019-02-02T22:12:40+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/serve-register-discovery/" itemprop="url" rel="index"><span itemprop="name">serve register discovery</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h6 id="服务配置"><a href="#服务配置" class="headerlink" title="服务配置"></a>服务配置</h6><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dubbo:application</span> <span class="attr">name</span>=<span class="string">"taotao-manager"</span>/&gt;</span></span><br><span class="line">​    <span class="tag">&lt;<span class="name">dubbo:registry</span> <span class="attr">address</span>=<span class="string">"zookeeper://106.15.xxx.xxx:2181"</span> /&gt;</span></span><br><span class="line">​    <span class="tag">&lt;<span class="name">dubbo:protocol</span> <span class="attr">name</span>=<span class="string">"dubbo"</span> <span class="attr">port</span>=<span class="string">"20881"</span> /&gt;</span></span><br><span class="line">​    <span class="tag">&lt;<span class="name">dubbo:service</span> <span class="attr">interface</span>=<span class="string">"com.smniuhe.service.ItemService"</span> <span class="attr">ref</span>=<span class="string">"itemServiceImpl"</span> <span class="attr">timeout</span>=<span class="string">"300000"</span>/&gt;</span></span><br></pre></td></tr></table></figure>
<p>启动正常</p>
<h6 id="查看发布的服务"><a href="#查看发布的服务" class="headerlink" title="查看发布的服务"></a>查看发布的服务</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[zk: 106.15.191.27:2181(CONNECTED) 1] ls /dubbo/com.smniuhe.service.ItemService/providers</span><br><span class="line">[dubbo%3A%2F%2F192.168.0.28%3A20880%2Fcom.smniuhe.service.ItemService%3Fanyhost%3Dtrue%26application%3Dtaotao-manager%26dubbo%3D2.8.4</span><br><span class="line">%26generic%3Dfalse%26interface%3Dcom.smniuhe.service.ItemService%26methods%3DgetTbItemById%26pid%3D32659%26revision%3D1.0-</span><br><span class="line"> SNAPSHOT%26side%3Dprovider%26timeout%3D300000%26timestamp%3D1518972080865]</span><br></pre></td></tr></table></figure>    
<p>发现 192.168.0.28 是本地的 ip 地址</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/18/zookeeper-命令-查看发布的服务提供者和消费者/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/18/zookeeper-命令-查看发布的服务提供者和消费者/" class="post-title-link" itemprop="url">zookeeper 命令 查看发布的服务提供者和消费者</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-18 21:27:13" itemprop="dateCreated datePublished" datetime="2018-02-18T21:27:13+08:00">2018-02-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:13:15" itemprop="dateModified" datetime="2019-02-02T22:13:15+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/registration-center/" itemprop="url" rel="index"><span itemprop="name">registration center</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># pwd</span></span><br><span class="line">/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./zkCli.sh -server 127.0.0.1:2181</span></span><br><span class="line">Connecting to 127.0.0.1:2181</span><br><span class="line">2018-02-18 21:30:05,213 [myid:] - INFO  [main:Environment@100] - Client environment:zookeeper.version=3.4.10-39d3a4f269333c922ed3db283be479f9deacaa0f, built on 03/23/2017 10:13 GMT</span><br><span class="line">2018-02-18 21:30:05,216 [myid:] - INFO  [main:Environment@100] - Client environment:host.name=iZuf6iq8e7ya9v3ix71k0pZ</span><br><span class="line">2018-02-18 21:30:05,216 [myid:] - INFO  [main:Environment@100] - Client environment:java.version=1.8.0_111</span><br><span class="line">2018-02-18 21:30:05,218 [myid:] - INFO  [main:Environment@100] - Client environment:java.vendor=Oracle Corporation</span><br><span class="line">2018-02-18 21:30:05,218 [myid:] - INFO  [main:Environment@100] - Client environment:java.home=/usr/java/jdk1.8.0_111/jre</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:java.class.path=/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../build/classes:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../build/lib/*.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../lib/slf4j-log4j12-1.6.1.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../lib/slf4j-api-1.6.1.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../lib/netty-3.10.5.Final.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../lib/log4j-1.2.16.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../lib/jline-0.9.94.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../zookeeper-3.4.10.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../src/java/lib/*.jar:/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin/../conf:</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:java.library.path=/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/lib</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:java.io.tmpdir=/tmp</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:java.compiler=&lt;NA&gt;</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:os.name=Linux</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:os.arch=amd64</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:os.version=3.10.0-514.26.2.el7.x86_64</span><br><span class="line">2018-02-18 21:30:05,219 [myid:] - INFO  [main:Environment@100] - Client environment:user.name=root</span><br><span class="line">2018-02-18 21:30:05,220 [myid:] - INFO  [main:Environment@100] - Client environment:user.home=/root</span><br><span class="line">2018-02-18 21:30:05,220 [myid:] - INFO  [main:Environment@100] - Client environment:user.dir=/usr/<span class="built_in">local</span>/zookeeper/zookeeper-3.4.10/bin</span><br><span class="line">2018-02-18 21:30:05,221 [myid:] - INFO  [main:ZooKeeper@438] - Initiating client connection, connectString=127.0.0.1:2181 sessionTimeout=30000 watcher=org.apache.zookeeper.ZooKeeperMain<span class="variable">$MyWatcher</span>@277050dc</span><br><span class="line">Welcome to ZooKeeper!</span><br><span class="line">2018-02-18 21:30:05,243 [myid:] - INFO  [main-SendThread(127.0.0.1:2181):ClientCnxn<span class="variable">$SendThread</span>@1032] - Opening socket connection to server 127.0.0.1/127.0.0.1:2181. Will not attempt to authenticate using SASL (unknown error)</span><br><span class="line">JLine support is enabled</span><br><span class="line">2018-02-18 21:30:05,308 [myid:] - INFO  [main-SendThread(127.0.0.1:2181):ClientCnxn<span class="variable">$SendThread</span>@876] - Socket connection established to 127.0.0.1/127.0.0.1:2181, initiating session</span><br><span class="line">2018-02-18 21:30:05,315 [myid:] - INFO  [main-SendThread(127.0.0.1:2181):ClientCnxn<span class="variable">$SendThread</span>@1299] - Session establishment complete on server 127.0.0.1/127.0.0.1:2181, sessionid = 0x161a83a11fc0007, negotiated timeout = 30000</span><br><span class="line"></span><br><span class="line">WATCHER::</span><br><span class="line"></span><br><span class="line">WatchedEvent state:SyncConnected <span class="built_in">type</span>:None path:null</span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 0] ls /</span><br><span class="line">[dubbo, zookeeper]</span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 1] ls /dubbo</span><br><span class="line">[com.smniuhe.service.ItemService]</span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 2] ls /dubbo/com.smniuhe.service.ItemService/providers</span><br><span class="line">[]</span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 3]</span><br><span class="line"></span><br><span class="line">现在我通过 tomcat maven 插件 tomcat7:run 发布该服务</span><br><span class="line"></span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 3] ls /dubbo/com.smniuhe.service.ItemService/providers</span><br><span class="line">[dubbo%3A%2F%2F192.168.0.28%3A20880%2Fcom.smniuhe.service.ItemService%3Fanyhost%3Dtrue%26application%3Dtaotao-manager%26dubbo%3D2.8.4%26generic%3Dfalse%26interface%3Dcom.smniuhe.service.ItemService%26methods%3DgetTbItemById%26pid%3D31972%26revision%3D1.0-SNAPSHOT%26side%3Dprovider%26timestamp%3D1518960843164]  <span class="comment"># 当前发布服务器的时间戳</span></span><br><span class="line">[zk: 127.0.0.1:2181(CONNECTED) 4] ls /dubbo/com.smniuhe.service.ItemService/</span><br><span class="line"></span><br><span class="line">configurators   providers</span><br></pre></td></tr></table></figure>    

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/18/zookeeper-注册中心的简单搭建/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/18/zookeeper-注册中心的简单搭建/" class="post-title-link" itemprop="url">zookeeper 注册中心的简单搭建</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-18 14:12:15" itemprop="dateCreated datePublished" datetime="2018-02-18T14:12:15+08:00">2018-02-18</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:13:15" itemprop="dateModified" datetime="2019-02-02T22:13:15+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/registration-center/" itemprop="url" rel="index"><span itemprop="name">registration center</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h5 id="zookeeper-官网"><a href="#zookeeper-官网" class="headerlink" title="zookeeper 官网"></a>zookeeper 官网</h5><a href="http://zookeeper.apache.org/" title="[官网][官网地址]" target="_blank" rel="noopener">官网地址</a>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/02/18/zookeeper-注册中心的简单搭建/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/13/redis-简单部署/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/13/redis-简单部署/" class="post-title-link" itemprop="url">redis 简单部署</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-13 14:42:36" itemprop="dateCreated datePublished" datetime="2018-02-13T14:42:36+08:00">2018-02-13</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:13:07" itemprop="dateModified" datetime="2019-02-02T22:13:07+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/NoSQL/" itemprop="url" rel="index"><span itemprop="name">NoSQL</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h6 id="redis-官网"><a href="#redis-官网" class="headerlink" title="redis 官网"></a>redis 官网</h6><a href="https://redis.io/" title="[官网] [官网地址]" target="_blank" rel="noopener">官网地址</a>
<h6 id="redis-部署概括"><a href="#redis-部署概括" class="headerlink" title="redis 部署概括"></a>redis 部署概括</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ wget http://download.redis.io/releases/redis-4.0.8.tar.gz</span><br><span class="line">$ tar xzf redis-4.0.8.tar.gz</span><br><span class="line">$ <span class="built_in">cd</span> redis-4.0.8</span><br><span class="line">$ make</span><br><span class="line"></span><br><span class="line">&lt;!-- more --&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">## redis-server前端启动</span></span><br><span class="line">$ src/redis-server</span><br><span class="line"></span><br><span class="line"><span class="comment">## redis-cli 启动</span></span><br><span class="line">$ src/redis-cli</span><br><span class="line">redis&gt; <span class="built_in">set</span> foo bar</span><br><span class="line">OK</span><br><span class="line">redis&gt; get foo</span><br><span class="line"><span class="string">"bar"</span></span><br></pre></td></tr></table></figure>    
<h6 id="redis-实际部署"><a href="#redis-实际部署" class="headerlink" title="redis 实际部署"></a>redis 实际部署</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># pwd</span></span><br><span class="line">/usr/<span class="built_in">local</span>/redis</span><br><span class="line"></span><br><span class="line"><span class="comment">## 下载redis解压包</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># wget http://download.redis.io/releases/redis-4.0.8.tar.gz</span></span><br><span class="line">--2018-02-13 14:12:36--  http://download.redis.io/releases/redis-4.0.8.tar.gz</span><br><span class="line">正在解析主机 download.redis.io (download.redis.io)... 109.74.203.151</span><br><span class="line">正在连接 download.redis.io (download.redis.io)|109.74.203.151|:80... 已连接。</span><br><span class="line">已发出 HTTP 请求，正在等待回应... 200 OK</span><br><span class="line">长度：1729973 (1.6M) [application/x-gzip]</span><br><span class="line">正在保存至: “redis-4.0.8.tar.gz”</span><br><span class="line"></span><br><span class="line">100%[=================================================================================================================================&gt;] 1,729,973    973KB/s 用时 1.7s</span><br><span class="line"></span><br><span class="line">2018-02-13 14:12:39 (973 KB/s) - 已保存 “redis-4.0.8.tar.gz” [1729973/1729973])</span><br><span class="line"></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># ll</span></span><br><span class="line">总用量 1692</span><br><span class="line">-rw-r--r-- 1 root root 1729973 2月   3 00:40 redis-4.0.8.tar.gz</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># tar xzf redis-4.0.8.tar.gz</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># ll</span></span><br><span class="line">总用量 1696</span><br><span class="line">drwxrwxr-x 6 root root    4096 2月   3 00:39 redis-4.0.8</span><br><span class="line">-rw-r--r-- 1 root root 1729973 2月   3 00:40 redis-4.0.8.tar.gz</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># cd redis-4.0.8</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 自动配置</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis-4.0.8]<span class="comment"># make</span></span><br><span class="line"><span class="built_in">cd</span> src &amp;&amp; make all</span><br><span class="line">make[1]: 进入目录“/usr/<span class="built_in">local</span>/redis/redis-4.0.8/src”</span><br><span class="line">​    CC Makefile.dep</span><br><span class="line">make[1]: 离开目录“/usr/<span class="built_in">local</span>/redis/redis-4.0.8/src”</span><br><span class="line">make[1]: 进入目录“/usr/<span class="built_in">local</span>/redis/redis-4.0.8/src”</span><br><span class="line">​        ...</span><br><span class="line">​    ...</span><br><span class="line">​    ...</span><br><span class="line">​    CC redis-benchmark.o</span><br><span class="line">​    LINK redis-benchmark</span><br><span class="line">​    INSTALL redis-check-rdb</span><br><span class="line">​    INSTALL redis-check-aof</span><br><span class="line"></span><br><span class="line">Hint: It<span class="string">'s a good idea to run '</span>make <span class="built_in">test</span><span class="string">' ;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">make[1]: 离开目录“/usr/local/redis/redis-4.0.8/src”</span></span><br><span class="line"><span class="string">[root@iZuf6iq8e7ya9v3ix71k0pZ redis-4.0.8]# ls</span></span><br><span class="line"><span class="string">00-RELEASENOTES  CONTRIBUTING  deps     Makefile   README.md   runtest          runtest-sentinel  src    utils</span></span><br><span class="line"><span class="string">BUGS             COPYING       INSTALL  MANIFESTO  redis.conf  runtest-cluster  sentinel.conf     tests</span></span><br><span class="line"><span class="string">[root@iZuf6iq8e7ya9v3ix71k0pZ redis-4.0.8]# ll</span></span><br><span class="line"><span class="string">总用量 296</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root 150927 2月   3 00:39 00-RELEASENOTES</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root     53 2月   3 00:39 BUGS</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root   1815 2月   3 00:39 CONTRIBUTING</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root   1487 2月   3 00:39 COPYING</span></span><br><span class="line"><span class="string">drwxrwxr-x  6 root root   4096 2月  13 14:14 deps</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root     11 2月   3 00:39 INSTALL</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root    151 2月   3 00:39 Makefile</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root   4223 2月   3 00:39 MANIFESTO</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root  20543 2月   3 00:39 README.md</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root  58353 2月   3 00:39 redis.conf</span></span><br><span class="line"><span class="string">-rwxrwxr-x  1 root root    271 2月   3 00:39 runtest</span></span><br><span class="line"><span class="string">-rwxrwxr-x  1 root root    280 2月   3 00:39 runtest-cluster</span></span><br><span class="line"><span class="string">-rwxrwxr-x  1 root root    281 2月   3 00:39 runtest-sentinel</span></span><br><span class="line"><span class="string">-rw-rw-r--  1 root root   7606 2月   3 00:39 sentinel.conf</span></span><br><span class="line"><span class="string">drwxrwxr-x  3 root root   4096 2月  13 14:15 src</span></span><br><span class="line"><span class="string">drwxrwxr-x 10 root root   4096 2月   3 00:39 tests</span></span><br><span class="line"><span class="string">drwxrwxr-x  8 root root   4096 2月   3 00:39 utils</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">## 将启动目录配置到父目录同级下</span></span><br><span class="line"><span class="string">[root@iZuf6iq8e7ya9v3ix71k0pZ redis-4.0.8]# make PREFIX=/usr/local/redis install</span></span><br><span class="line"><span class="string">cd src &amp;&amp; make install</span></span><br><span class="line"><span class="string">make[1]: 进入目录“/usr/local/redis/redis-4.0.8/src”</span></span><br><span class="line"><span class="string">​    CC Makefile.dep</span></span><br><span class="line"><span class="string">make[1]: 离开目录“/usr/local/redis/redis-4.0.8/src”</span></span><br><span class="line"><span class="string">make[1]: 进入目录“/usr/local/redis/redis-4.0.8/src”</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Hint: It'</span>s a good idea to run <span class="string">'make test'</span> ;)</span><br><span class="line"></span><br><span class="line">    INSTALL install</span><br><span class="line">    INSTALL install</span><br><span class="line">    INSTALL install</span><br><span class="line">    INSTALL install</span><br><span class="line">    INSTALL install</span><br><span class="line">make[1]: 离开目录“/usr/<span class="built_in">local</span>/redis/redis-4.0.8/src”</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis-4.0.8]<span class="comment"># cd ..</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># ll</span></span><br><span class="line">总用量 1700</span><br><span class="line">drwxr-xr-x 2 root root    4096 2月  13 14:23 bin</span><br><span class="line">drwxrwxr-x 6 root root    4096 2月   3 00:39 redis-4.0.8</span><br><span class="line">-rw-r--r-- 1 root root 1729973 2月   3 00:40 redis-4.0.8.tar.gz</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># cd bin</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ll</span></span><br><span class="line">总用量 21836</span><br><span class="line">-rwxr-xr-x 1 root root 2450960 2月  13 14:23 redis-benchmark</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-aof</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2616128 2月  13 14:23 redis-cli</span><br><span class="line">lrwxrwxrwx 1 root root      12 2月  13 14:23 redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-server</span><br><span class="line"></span><br><span class="line"><span class="comment">## 前端启动（关闭窗口，则服务关闭） </span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./redis-server </span></span><br><span class="line">21156:C 13 Feb 14:25:25.281 <span class="comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></span><br><span class="line">21156:C 13 Feb 14:25:25.281 <span class="comment"># Redis version=4.0.8, bits=64, commit=00000000, modified=0, pid=21156, just started</span></span><br><span class="line">21156:C 13 Feb 14:25:25.281 <span class="comment"># Warning: no config file specified, using the default config. In order to specify a config file use ./redis-server /path/to/redis.conf</span></span><br><span class="line">​                _._</span><br><span class="line">​           _.-``__ <span class="string">''</span>-._</span><br><span class="line">​      _.-``    `.  `_.  <span class="string">''</span>-._           Redis 4.0.8 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ <span class="string">''</span>-._</span><br><span class="line"> (    <span class="string">'      ,       .-`  | `,    )     Running in standalone mode</span></span><br><span class="line"><span class="string"> |`-._`-...-` __...-.``-._|'</span>` _.-<span class="string">'|     Port: 6379</span></span><br><span class="line"><span class="string"> |    `-._   `._    /     _.-'</span>    |     PID: 21156</span><br><span class="line">  `-._    `-._  `-./  _.-<span class="string">'    _.-'</span></span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|</span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-'</span>_.-<span class="string">'    |           http://redis.io</span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-'</span>_.-<span class="string">'    _.-'</span></span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|</span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-'</span>_.-<span class="string">'    |</span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-'</span>_.-<span class="string">'    _.-'</span></span><br><span class="line">​      `-._    `-.__.-<span class="string">'    _.-'</span></span><br><span class="line">​          `-._        _.-<span class="string">'</span></span><br><span class="line"><span class="string">​              `-.__.-'</span></span><br><span class="line"></span><br><span class="line">21156:M 13 Feb 14:25:25.283 <span class="comment"># Server initialized</span></span><br><span class="line">21156:M 13 Feb 14:25:25.283 <span class="comment"># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add 'vm.overcommit_memory = 1' to /etc/sysctl.conf and then reboot or run the command 'sysctl vm.overcommit_memory=1' for this to take effect.</span></span><br><span class="line">21156:M 13 Feb 14:25:25.283 <span class="comment"># WARNING you have Transparent Huge Pages (THP) support enabled in your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the command 'echo never &gt; /sys/kernel/mm/transparent_hugepage/enabled' as root, and add it to your /etc/rc.local in order to retain the setting after a reboot. Redis must be restarted after THP is disabled.</span></span><br><span class="line">21156:M 13 Feb 14:25:25.283 * Ready to accept connections</span><br><span class="line">^C21156:signal-handler (1518503420) Received SIGINT scheduling shutdown...</span><br><span class="line">21156:M 13 Feb 14:30:20.926 <span class="comment"># User requested shutdown...</span></span><br><span class="line">21156:M 13 Feb 14:30:20.926 * Saving the final RDB snapshot before exiting.</span><br><span class="line">21156:M 13 Feb 14:30:20.928 * DB saved on disk</span><br><span class="line">21156:M 13 Feb 14:30:20.929 <span class="comment"># Redis is now ready to exit, bye bye...</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 配置后端启动（可以关闭窗口）</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># cp ../redis-4.0.8/redis.conf</span></span><br><span class="line">cp: 在<span class="string">"../redis-4.0.8/redis.conf"</span> 后缺少了要操作的目标文件</span><br><span class="line">Try <span class="string">'cp --help'</span> <span class="keyword">for</span> more information.</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># cp ../redis-4.0.8/redis.conf /usr/local/redis/bin/</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ll</span></span><br><span class="line">总用量 21900</span><br><span class="line">-rw-r--r-- 1 root root      92 2月  13 14:30 dump.rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2450960 2月  13 14:23 redis-benchmark</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-aof</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2616128 2月  13 14:23 redis-cli</span><br><span class="line">-rw-r--r-- 1 root root   58353 2月  13 14:31 redis.conf</span><br><span class="line">lrwxrwxrwx 1 root root      12 2月  13 14:23 redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-server</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># chmod 777 redis.conf</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ll</span></span><br><span class="line">总用量 21900</span><br><span class="line">-rw-r--r-- 1 root root      92 2月  13 14:30 dump.rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2450960 2月  13 14:23 redis-benchmark</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-aof</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2616128 2月  13 14:23 redis-cli</span><br><span class="line">-rwxrwxrwx 1 root root   58353 2月  13 14:31 redis.conf</span><br><span class="line">lrwxrwxrwx 1 root root      12 2月  13 14:23 redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-server</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># vim redis.conf</span></span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="comment"># By default Redis does not run as a daemon. Use 'yes' if you need it.</span></span><br><span class="line"><span class="comment"># Note that Redis will write a pid file in /var/run/redis.pid when daemonized.</span></span><br><span class="line">daemonize yes</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./redis-server redis.conf</span></span><br><span class="line">21167:C 13 Feb 14:34:45.321 <span class="comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></span><br><span class="line">21167:C 13 Feb 14:34:45.321 <span class="comment"># Redis version=4.0.8, bits=64, commit=00000000, modified=0, pid=21167, just started</span></span><br><span class="line">21167:C 13 Feb 14:34:45.321 <span class="comment"># Configuration loaded</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ps aux|grep redis</span></span><br><span class="line">root     21168  0.0  0.1 145252  7556 ?        Ssl  14:34   0:00 ./redis-server 127.0.0.1:6379</span><br><span class="line">root     21173  0.0  0.0 112664   976 pts/0    S+   14:35   0:00 grep --color=auto redis</span><br><span class="line"></span><br><span class="line"><span class="comment">## 启动 redis 实例，并简单set,get</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name niuhe</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"niuhe"</span></span><br><span class="line">127.0.0.1:6379&gt;</span><br></pre></td></tr></table></figure>
<h6 id="jedis-客户端操作"><a href="#jedis-客户端操作" class="headerlink" title="jedis 客户端操作"></a>jedis 客户端操作</h6><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">​	<span class="meta">@Test</span></span><br><span class="line">​    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testJedis</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/**</span></span><br><span class="line"><span class="comment">         * redis.clients.jedis.exceptions.JedisConnectionException: java.net.ConnectException: Connection refused (Connection refused)</span></span><br><span class="line"><span class="comment">         at redis.clients.jedis.Connection.connect(Connection.java:207)</span></span><br><span class="line"><span class="comment">         解决：</span></span><br><span class="line"><span class="comment">         vim redis.conf</span></span><br><span class="line"><span class="comment">         # bind 127.0.0.0.1</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">         redis.clients.jedis.exceptions.JedisDataException: DENIED Redis is running in protected mode because</span></span><br><span class="line"><span class="comment">         protected mode is enabled, no bind address was specified, no authentication password is requested to clients.</span></span><br><span class="line"><span class="comment">         In this mode connections are only accepted from the loopback interface. If you want to connect from external</span></span><br><span class="line"><span class="comment">         computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the</span></span><br><span class="line"><span class="comment">         command 'CONFIG SET protected-mode no' from the loopback interface by connecting to Redis from the same host</span></span><br><span class="line"><span class="comment">         the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use</span></span><br><span class="line"><span class="comment">         CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by</span></span><br><span class="line"><span class="comment">         editing the Redis configuration file, and setting the protected mode option to 'no', and then restarting the</span></span><br><span class="line"><span class="comment">         server. 3) If you started the server manually just for testing, restart it with the '--protected-mode no' option</span></span><br><span class="line"><span class="comment">         . 4) Setup a bind address or an authentication password. <span class="doctag">NOTE:</span> You only need to do one of the above things in order</span></span><br><span class="line"><span class="comment">         for the server to start accepting connections from the outside.</span></span><br><span class="line"><span class="comment">         解决：</span></span><br><span class="line"><span class="comment">         vim redis.conf</span></span><br><span class="line"><span class="comment">         protected-mode yes 改成</span></span><br><span class="line"><span class="comment">         protected-mode no</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">"smniuhe.com"</span>, <span class="number">6379</span>);</span><br><span class="line">        jedis.set(<span class="string">"name"</span>, <span class="string">"smniuhe"</span>);</span><br><span class="line">        System.out.println(jedis.get(<span class="string">"name"</span>));</span><br><span class="line">        jedis.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h6 id="两种持久化方案"><a href="#两种持久化方案" class="headerlink" title="两种持久化方案"></a>两种持久化方案</h6><ul>
<li>rdb(默认)<ul>
<li>可以设置间隔多长时间保存一次(Redis不用任何配置默认的持久化方案)<br>  有点:让redis的数据存取速度变快<br>  缺点:服务器断电时会丢失部分数据(数据的完整性得不到保</li>
</ul>
</li>
<li>aop<ul>
<li>可以设置实时保存<br>  优点:持久化良好,能包装数据的完整性<br>  缺点:大大降低了redis系统的存取速度</li>
<li>设置为 aop 策略<br>修改 redis.conf 配置文件 appendonly yes </li>
</ul>
</li>
</ul>
<h6 id="主从复制"><a href="#主从复制" class="headerlink" title="主从复制"></a>主从复制</h6><ul>
<li>模拟 redis 集群（从服务器只能读取）<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ll</span></span><br><span class="line">总用量 21900</span><br><span class="line">-rw-r--r-- 1 root root     197 2月  14 18:19 dump.rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2450960 2月  13 14:23 redis-benchmark</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-aof</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-check-rdb</span><br><span class="line">-rwxr-xr-x 1 root root 2616128 2月  13 14:23 redis-cli</span><br><span class="line">-rwxrwxrwx 1 root root   58356 2月  13 16:04 redis.conf</span><br><span class="line">lrwxrwxrwx 1 root root      12 2月  13 14:23 redis-sentinel -&gt; redis-server</span><br><span class="line">-rwxr-xr-x 1 root root 5762432 2月  13 14:23 redis-server</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># rm -rf dump.rdb</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ../</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># mkdir bin2</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># cp bin/* bin2/</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ redis]<span class="comment"># cp bin2</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># vim redis.conf</span></span><br><span class="line">修改 redis-cli 启动的端口号</span><br><span class="line">port = 6380</span><br><span class="line"><span class="comment"># 设置主的端口 ip port</span></span><br><span class="line"><span class="comment"># slaveof &lt;masterip&gt; &lt;masterport&gt;</span></span><br><span class="line">slaveof 106.15.191.27 6379</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./redis-server redis.conf</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-server redis.conf</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-server redis.conf</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ps -aux|grep redis</span></span><br><span class="line">root     21266  0.0  0.2 147300  9768 ?        Ssl  2月13   1:10 ./redis-server *:6379</span><br><span class="line">root     21847  0.0  0.2 147300  9688 ?        Ssl  18:16   0:00 ./redis-server *:6380</span><br><span class="line">root     21853  0.0  0.0 112664   976 pts/0    S+   18:16   0:00 grep --color=auto redis</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-cli</span></span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> name smniuhe79</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get name</span><br><span class="line"><span class="string">"smniuhe79"</span></span><br><span class="line">127.0.0.1:6379&gt;</span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># cd ../bin</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin]<span class="comment"># ./redis-cli shutdown</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-cli -p 6380</span></span><br><span class="line">127.0.0.1:6380&gt; get name</span><br><span class="line"><span class="string">"smniuhe79"</span></span><br><span class="line">127.0.0.1:6380&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定ip地址和port</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-cli -h ip -p 6380</span></span><br><span class="line">106.15.191.27:6380&gt; get name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定校验密码</span></span><br><span class="line">[root@iZuf6iq8e7ya9v3ix71k0pZ bin2]<span class="comment"># ./redis-cli -h ip -p port -a authpassword</span></span><br><span class="line">106.15.191.27:6380&gt; get name</span><br><span class="line"></span><br><span class="line"><span class="comment"># 正常关闭实例</span></span><br><span class="line">106.15.191.27:6380&gt; shutdown</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/11/solr-7-2-tomcat-的部署/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/11/solr-7-2-tomcat-的部署/" class="post-title-link" itemprop="url">solr 7.2 + tomcat 的部署</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-11 23:02:00" itemprop="dateCreated datePublished" datetime="2018-02-11T23:02:00+08:00">2018-02-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:13:10" itemprop="dateModified" datetime="2019-02-02T22:13:10+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/server/" itemprop="url" rel="index"><span itemprop="name">server</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h6 id="官网下载"><a href="#官网下载" class="headerlink" title="官网下载"></a>官网下载</h6><a href="http://mirrors.hust.edu.cn/apache/lucene/solr/7.2.1" title="[官网] [下载地址]" target="_blank" rel="noopener">solr7.2.1</a>
<h6 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">➜  solr-7.2.1 ll</span><br><span class="line">total 2896</span><br><span class="line">-rw-r--r--@   1 niuhesm  staff   737K  1 10 05:32 CHANGES.txt </span><br><span class="line">-rw-r--r--@   1 niuhesm  staff    12K  1 10 05:26 LICENSE.txt</span><br><span class="line">-rw-r--r--@   1 niuhesm  staff   652K  1 10 05:32 LUCENE_CHANGES.txt</span><br><span class="line">-rw-r--r--@   1 niuhesm  staff    24K  1 10 05:26 NOTICE.txt</span><br><span class="line">-rw-r--r--@   1 niuhesm  staff   7.3K  1 10 05:26 README.txt</span><br><span class="line">drwxr-xr-x@  12 niuhesm  staff   408B  2 11 22:44 bin <span class="comment"># 生成core实例</span></span><br><span class="line">drwxr-xr-x@  11 niuhesm  staff   374B  1 10 08:54 contrib</span><br><span class="line">drwxr-xr-x@  18 niuhesm  staff   612B  2 11 12:30 dist</span><br><span class="line">drwxr-xr-x@   4 niuhesm  staff   136B  2 11 12:28 docs</span><br><span class="line">drwxr-xr-x@   9 niuhesm  staff   306B  2 11 12:30 example</span><br><span class="line">drwxr-xr-x@ 535 niuhesm  staff    18K  1 10 05:32 licenses</span><br><span class="line">drwxr-xr-x@  14 niuhesm  staff   476B  2 11 22:43 server</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/02/11/solr-7-2-tomcat-的部署/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/09/从未注意的分隔符问题/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/09/从未注意的分隔符问题/" class="post-title-link" itemprop="url">从未注意的分隔符问题</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-09 10:48:19" itemprop="dateCreated datePublished" datetime="2018-02-09T10:48:19+08:00">2018-02-09</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:13:18" itemprop="dateModified" datetime="2019-02-02T22:13:18+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/charset/" itemprop="url" rel="index"><span itemprop="name">charset</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h6 id="Git-Commit-Failed"><a href="#Git-Commit-Failed" class="headerlink" title="Git Commit Failed"></a>Git Commit Failed</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">上午10:32	Commit failed with error</span><br><span class="line">​	0 files committed, 4 files failed to commit: 1.更新分词器配置文件</span><br><span class="line">​	warning: CRLF will be replaced by LF <span class="keyword">in</span> src/main/resources/IKAnalyzer.cfg.xml.</span><br><span class="line">​	The file will have its original line endings <span class="keyword">in</span> your working directory.</span><br></pre></td></tr></table></figure>    
<p>大概是意思是说 xml 文件有它原始的行编码格式 CRLF，CRLF 并将替换成 LF 的行编码格式，可能是转换的时候出错啦，导致整个 Commit failed</p>
          <!--noindex-->
          
            <div class="post-button text-center">
              <a class="btn" href="/2018/02/09/从未注意的分隔符问题/#more" rel="contents">
                Read more &raquo;
              </a>
            </div>
          
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/02/jEnv/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/02/jEnv/" class="post-title-link" itemprop="url">macOS 中 Java 版本管理的好帮手 jEnv</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-02 10:43:27" itemprop="dateCreated datePublished" datetime="2018-02-02T10:43:27+08:00">2018-02-02</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:12:43" itemprop="dateModified" datetime="2019-02-02T22:12:43+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/VC/" itemprop="url" rel="index"><span itemprop="name">VC</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h6 id="困恼"><a href="#困恼" class="headerlink" title="困恼"></a>困恼</h6><p>在开发的时候每个人配置 Java 环境都不一样， 或者开发者都有多个版本的 jdk，比如：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当前版本</span></span><br><span class="line">➜  ~ java -version</span><br><span class="line">java version <span class="string">"1.8.0_121"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_121-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所有的版本</span></span><br><span class="line">➜  ~ ll /Library/Java/JavaVirtualMachines</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x  3 root  wheel   102B  6  3  2017 jdk1.7.0_80.jdk</span><br><span class="line">drwxr-xr-x  3 root  wheel   102B  4 12  2017 jdk1.8.0_121.jdk</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure></p>
<h6 id="jEnv-介绍"><a href="#jEnv-介绍" class="headerlink" title="jEnv 介绍"></a>jEnv 介绍</h6><blockquote><p>Java 生态中包含大量的你可能想使用的工具，包括 Java 本身到一些构建工具，如 Maven 和 Gradle，以及第三方应用如 ActiveMQ 和 Tomcat 等。经常你会需要同时使用这些工具的不同版本，用于不同的项目，或者想对一个项目在不同版本的环境中做兼容性测试。</p>
<p>管理这些不同版本的工具是一项非常复杂的任务。每个工具有各自不同的获取方式，如果安装，如何控制都是很成问题的。</p>
<p>值得庆幸的是，jenv 可以帮你轻松搞定这个复杂的工作（请注意该工具不同于 jEnv, 这是用来设置 JAVA_HOME 环境变量的）。jenv 支持 Windows、Mac 和 Linux – 可以轻松管理大量基于 Java 开发的工具的多个版本。目前已经支持超过 200 个不同的工具。</p>
<footer><strong>jenv 介绍</strong><cite><a href="http://www.jenv.be/" target="_blank" rel="noopener">官网</a></cite></footer></blockquote>
<h6 id="jEnv-安装"><a href="#jEnv-安装" class="headerlink" title="jEnv 安装"></a>jEnv 安装</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ brew install jenv</span><br><span class="line"><span class="comment"># bash</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'export PATH="$HOME/.jenv/bin:$PATH"'</span> &gt;&gt; ~/.bash_profile</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'eval "$(jenv init -)"'</span> &gt;&gt; ~/.bash_profile</span><br><span class="line"><span class="comment"># zsh</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'export PATH="$HOME/.jenv/bin:$PATH"'</span> &gt;&gt; ~/.zshrc</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">'eval "$(jenv init -)"'</span> &gt;&gt; ~/.zshrc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看版本</span></span><br><span class="line">➜  ~ jenv versions</span><br><span class="line">* system (<span class="built_in">set</span> by /Users/niuhesm/.jenv/version)</span><br><span class="line">➜  ~ bash</span><br><span class="line">bash-3.2$ jenv versions</span><br><span class="line">* system (<span class="built_in">set</span> by /Users/niuhesm/.jenv/version)</span><br><span class="line">bash-3.2$ zsh</span><br><span class="line">➜  ~ open ~/.bash_profile</span><br></pre></td></tr></table></figure>
<p>它只找到了系统默认的Java，即使我已经下载了其他版本的Java。*表示当前选择的版本。</p>
<h6 id="添加-Java-版本"><a href="#添加-Java-版本" class="headerlink" title="添加 Java 版本"></a>添加 Java 版本</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ jenv add /Library/Java/JavaVirtualMachines/jdk1.7.0_80.jdk/Contents/Home/</span><br><span class="line">oracle64-1.7.0.80 added</span><br><span class="line">1.7.0.80 added</span><br><span class="line">1.7 added</span><br><span class="line">➜  ~ jenv add /Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/</span><br><span class="line">oracle64-1.8.0.121 added</span><br><span class="line">1.8.0.121 added</span><br><span class="line">1.8 added</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新查看版本</span></span><br><span class="line">➜  ~ jenv versions</span><br><span class="line">* system (<span class="built_in">set</span> by /Users/niuhesm/.jenv/version)</span><br><span class="line">  1.7</span><br><span class="line">  1.7.0.80</span><br><span class="line">  1.8</span><br><span class="line">  1.8.0.121</span><br><span class="line">  oracle64-1.7.0.80</span><br><span class="line">  oracle64-1.8.0.121</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 只保留一个版本</span></span><br><span class="line">➜  ~ ....</span><br><span class="line">➜  ~ jenv remove oracle64-1.7.0.80</span><br><span class="line">JDK oracle64-1.7.0.80 removed</span><br><span class="line">➜  ~ jenv remove oracle64-1.8.0.121</span><br><span class="line">JDK oracle64-1.8.0.121 removed</span><br><span class="line">➜  ~ jenv versions</span><br><span class="line">* system (<span class="built_in">set</span> by /Users/niuhesm/.jenv/version)</span><br><span class="line">  1.7.0.80</span><br><span class="line">  1.8.0.121</span><br><span class="line">➜  ~</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定版本</span></span><br><span class="line">➜  ~ java -version</span><br><span class="line">java version <span class="string">"1.7.0_80"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.7.0_80-b15)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 24.80-b11, mixed mode)</span><br><span class="line">➜  ~ jenv <span class="built_in">local</span> 1.8.0.121 <span class="comment"># 指定当前的运行版本</span></span><br><span class="line">➜  ~ java -version</span><br><span class="line">java version <span class="string">"1.8.0_121"</span></span><br><span class="line">Java(TM) SE Runtime Environment (build 1.8.0_121-b13)</span><br><span class="line">Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)</span><br><span class="line">➜  ~ jenv <span class="built_in">which</span> java  <span class="comment"># 显示可执行的Java的完整路径</span></span><br><span class="line">/Users/niuhesm/.jenv/versions/1.8.0.121/bin/java</span><br><span class="line">➜  ~</span><br></pre></td></tr></table></figure>
<p>这当然不是真实的路径，而是一个硬链接。你可以找到 /Users/kmyhy/.jenv/versions/ 目录，发现所有的 java 版本都被列在了这里，这些硬链接（相当于 windows 的快捷方式）都指向了对应的 java 安装目录。<br>你还可以指定一个全局的版本<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">➜  ~ jenv global 1.7.0_80</span><br></pre></td></tr></table></figure><br>这样，默认的 java 版本就是 1.7.0_80 了。如果你想在某个项目中使用 1.7.0_80 版本，可以在项目文件夹下新建一个.java-version 文件，将文件内容编辑为 1.7.0_80 保存。这样，你进入这个文件夹时 jenv 会自动使用 1.7.0_80 作为当前版本（即 local 版本）。</p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/02/01/centos7-2搭建gitlab/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/02/01/centos7-2搭建gitlab/" class="post-title-link" itemprop="url">CentOS 上搭建 gitlab</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-02-01 16:16:40" itemprop="dateCreated datePublished" datetime="2018-02-01T16:16:40+08:00">2018-02-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:12:25" itemprop="dateModified" datetime="2019-02-02T22:12:25+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/VC/" itemprop="url" rel="index"><span itemprop="name">VC</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h6 id="GitLab-介绍"><a href="#GitLab-介绍" class="headerlink" title="GitLab 介绍"></a>GitLab 介绍</h6><blockquote><p>最近DevOps非常火, 而GitLab作为其中重要一环, 也越来越受重视, 与SVN相比, GitLab同样提供完美的用户权限管理, 与Git相比, 除了涵盖Git所有功能, 同时又提供方便的后台管理, 非常适合企业使用</p>
<footer><strong>殷临风</strong><cite><a href="https://www.jianshu.com/p/808fbf9d972f" target="_blank" rel="noopener">简书</a></cite></footer></blockquote>
<h6 id="GitLab-安装"><a href="#GitLab-安装" class="headerlink" title="GitLab 安装"></a>GitLab 安装</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 安装相关依赖</span></span><br><span class="line">yum install curl policycoreutils openssh-server openssh-clients -y</span><br><span class="line"><span class="comment"># 确保sshd启动(正常情况下, sshd是启动的)</span></span><br><span class="line">systemctl <span class="built_in">enable</span> sshd</span><br><span class="line">systemctl start sshd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 引入yum源, 并安装gitlab</span></span><br><span class="line">curl -sS https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash</span><br><span class="line">yum install gitlab-ce -y</span><br><span class="line"><span class="comment"># 配置并启动</span></span><br><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>
<h6 id="修改-Nginx-相关配置"><a href="#修改-Nginx-相关配置" class="headerlink" title="修改 Nginx 相关配置"></a>修改 Nginx 相关配置</h6><p>由于我用的是阿里云的 ESC，所以默认情况下防火墙的没有关闭的，且 GitLab 内置的 Nginx 默认端口是80，为了不占用这个特殊的端口，我们使用82端口，unicorn 端口也由8080改成8082，即nginx监听的rails端口，类似php-fpm，同样改成8082</p>
<ul>
<li>配置 Nginx 的默认端口<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br><span class="line"><span class="comment"># nginx['listen_port'] = nil 默认值即80</span></span><br><span class="line">nginx[<span class="string">'listen_port'</span>] = 82 </span><br><span class="line">vim /var/opt/gitlab/nginx/conf/gitlab-http.conf</span><br><span class="line"><span class="comment"># 默认值listen *:80;</span></span><br><span class="line">listen *:82; </span><br></pre></td></tr></table></figure></li>
<li><p>修改 unicorn 的默认端口和 Nginx 监听的 rails 端口</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/gitlab/gitlab.rb</span><br><span class="line"><span class="comment"># 原值unicorn['port'] = 8080</span></span><br><span class="line">unicorn[<span class="string">'port'</span>] = 8082</span><br><span class="line">vim /var/opt/gitlab/gitlab-rails/etc/unicorn.rb</span><br><span class="line"><span class="comment">#原值listen "127.0.0.1:8080", :tcp_nopush =&gt; true</span></span><br><span class="line">listen <span class="string">"127.0.0.1:8082"</span>, :tcp_nopush =&gt; <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载配置、启动</span></span><br><span class="line">gitlab-ctl reconfigure</span><br><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新加载配置、启动</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h6 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h6><p>由于我的服务器地址配置了域名解析，浏览器上输入 domain:82/ip地址:82，第一次会出现让你注册的界面，直接注册就行，下次输入地址会直接登录<br><img src="/2018/02/01/centos7-2搭建gitlab/GitLab登录成功界面.png" title="登录成功界面"></p>
<hr>
<h6 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h6><ol>
<li>GitLab 上需要配置本地的秘钥公约</li>
<li>新建仓库生成的url 都改成你服务器的 domain:82/ip地址:82，否则会访问失败</li>
<li>git,yum 相关的安装和命令都可以参看 <a href="http://www.runoob.com/" target="_blank" rel="noopener">runoob.com</a>  网站</li>
</ol>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/29/5-7之sql-model/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/29/5-7之sql-model/" class="post-title-link" itemprop="url">5.7之sql_model</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-01-29 17:50:40" itemprop="dateCreated datePublished" datetime="2018-01-29T17:50:40+08:00">2018-01-29</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:11:36" itemprop="dateModified" datetime="2019-02-02T22:11:36+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/sql/" itemprop="url" rel="index"><span itemprop="name">sql</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="问题发生背景"><a href="#问题发生背景" class="headerlink" title="问题发生背景"></a>问题发生背景</h5><p>今天在部署项目的时候发现，测试后台接口，直接报 500，仔细一看原来是操作数据库的时候报错了，在本地测试的时候是没遇到类似的问题，数据库的版本是一样的，后面查找资料，说是 MySQL 5.7 默认的 sql_model 配置是有 only_full_group_by，</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分组查询报错</span></span><br><span class="line">[Err] 1055 - Expression <span class="comment">#1 of SELECT list is not in GROUP BY clause and contains nonaggregated column 'leping.township_info.id' which is not functionally dependent on columns in GROUP BY clause; this is incompatible with sql_mode=only_full_group_by</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看当前MySQL sql_mode 配置</span></span><br><span class="line">mysql&gt; select version();</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| version() |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">| 5.7.18    |</span><br><span class="line">+<span class="comment">-----------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> @@sql_mode;</span><br><span class="line">+<span class="comment">--------------------------------------------+</span></span><br><span class="line">| @@sql_mode                                 |</span><br><span class="line">+<span class="comment">--------------------------------------------+</span></span><br><span class="line">| STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION |</span><br><span class="line">+<span class="comment">--------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<blockquote><p>only_full_group_by ：使用这个就是使用和oracle一样的group 规则, select的列都要在group中,或者本身是聚合列(SUM,AVG,MAX,MIN) 才行</p>
</blockquote>
<h5 id="解决的办法就是将这个-sql-model-的-only-full-group-by-参数去除"><a href="#解决的办法就是将这个-sql-model-的-only-full-group-by-参数去除" class="headerlink" title="解决的办法就是将这个 sql_model 的 only_full_group_by 参数去除"></a>解决的办法就是将这个 sql_model 的 only_full_group_by 参数去除</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sql_mode=<span class="string">'STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'</span></span><br></pre></td></tr></table></figure>
<ul>
<li>window server 服务器，直接找到 my.ini 配置文件，如果配置中没有对应的配置，先添加 sql_model ，有则直接移除 only_full_group_by</li>
<li>mac vim /etc/my.cof</li>
<li>centos 7 vim /etc/my.cof</li>
</ul>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/05/geotools解析Shapefile文件/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="smniuhe">
      <meta itemprop="description" content="大家好，我是牛河">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="smniuhe">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2018/01/05/geotools解析Shapefile文件/" class="post-title-link" itemprop="url">geotools解析Shapefile文件</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-01-05 11:37:06" itemprop="dateCreated datePublished" datetime="2018-01-05T11:37:06+08:00">2018-01-05</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-02-02 22:12:41" itemprop="dateModified" datetime="2019-02-02T22:12:41+08:00">2019-02-02</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/GEO/" itemprop="url" rel="index"><span itemprop="name">GEO</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h5 id="交代背景"><a href="#交代背景" class="headerlink" title="交代背景"></a>交代背景</h5><p>前段工程师给了我 <font color="gray" size="4"><a href="https://baike.baidu.com/item/%E5%9C%B0%E7%90%86%E4%BF%A1%E6%81%AF%E7%B3%BB%E7%BB%9F/171830?fromtitle=GIS&amp;fromid=31541" target="_blank" rel="noopener">gis</a></font> 相关的一些文件，想让我解析里面的数据，简单点就是解析 <font color="gray" size="4"><a href="https://baike.baidu.com/item/shapefile%E6%96%87%E4%BB%B6/11041662" target="_blank" rel="noopener">Shapefile</a></font> 文件，由于地理信息相关的数据都是 <font color="gray" size="4"><a href="https://baike.baidu.com/item/GeoJson" target="_blank" rel="noopener">GeoJson</a> </font>的数据格式；也是第一次接触 gis，所以先简单的了解了下这些专用的名词。</p>
<h5 id="Shapefile"><a href="#Shapefile" class="headerlink" title="Shapefile"></a>Shapefile</h5><blockquote><p>一个Shapefile文件最少包括三个文件：<br>主文件（<em>.shp）、–存储地理要素的几何图形的文件。<br>索引文件（</em>.shx）、–存储图形要素与属性信息索引的文件。<br>dBASE表文件（<em>.dbf），–存储要素信息属性的dBase表文件。<br>除此之外还有可选的文件包括：<br>空间参考文件（</em>.prj）、<br>几何体的空间索引文件（<em>.sbn 和 </em>.sbx）、<br>只读的Shapefiles的几何体的空间索引文件（<em>.fbn 和</em>.fbx）、<br>列表中活动字段的属性索引（<em>.ain 和 </em>.aih）、<br>可读写Shapefile文件的地理编码索引（.ixs）、<br>可读写Shapefile文件的地理编码索引（<em>.mxs）、<br>dbf文件的属性索引（</em>.atx）、<br>以XML格式保存元数据（<em>.shp.xml）、<br>用于描述.dbf文件的代码页，指明其使用的字符编码的描述文件（</em>.cpg）。</p>
<footer><strong>Shapefile百度百科</strong><cite><a href="https://baike.baidu.com/item/shapefile%E6%96%87%E4%BB%B6/11041662?fr=aladdin" target="_blank" rel="noopener">地址</a></cite></footer></blockquote>
<h5 id="Geotools"><a href="#Geotools" class="headerlink" title="Geotools"></a>Geotools</h5><blockquote><p>GeoTools 是英国利兹大学(University of Leeds)的James Macgll 从1996 年开始研发的一个操作和显示地图的开源Java 代码库，[1]  提供了一系列符合规范的操作地理空间数据的方法，例如可以用它来实现一个地理信息系统（GIS）。GeoTools库在开发时执行OGC规范。目前GeoTools的最新版本是 GeoTools 17 Releases。</p>
<footer><strong>GeoTools官网</strong><cite><a href="http://geotools.org/" target="_blank" rel="noopener">地址</a></cite></footer></blockquote>
<h5 id="Geojson"><a href="#Geojson" class="headerlink" title="Geojson"></a>Geojson</h5><blockquote><p>要素组合的数据格式如下：</p>
<footer><strong>简书</strong><cite><a href="https://www.jianshu.com/p/144033b1b87e" target="_blank" rel="noopener">brandonxiang</a></cite></footer></blockquote>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="attr">"type"</span>: <span class="string">"FeatureCollection"</span>,</span><br><span class="line">​    "features": [</span><br><span class="line">​      &#123; "type": "Feature",</span><br><span class="line">​        "geometry": &#123;"type": "Point", "coordinates": [102.0, 0.5]&#125;,</span><br><span class="line">​        "properties": &#123;"prop0": "value0"&#125;</span><br><span class="line">​        &#125;,</span><br><span class="line">​      &#123; "type": "Feature",</span><br><span class="line">​        "geometry": &#123;</span><br><span class="line">​          "type": "LineString",</span><br><span class="line">​          "coordinates": [</span><br><span class="line">​            [102.0, 0.0], [103.0, 1.0], [104.0, 0.0], [105.0, 1.0]</span><br><span class="line">​            ]</span><br><span class="line">​          &#125;,</span><br><span class="line">​        "properties": &#123;</span><br><span class="line">​          "prop0": "value0",</span><br><span class="line">​          "prop1": 0.0</span><br><span class="line">​          &#125;</span><br><span class="line">​        &#125;,</span><br><span class="line">​      &#123; "type": "Feature",</span><br><span class="line">​         "geometry": &#123;</span><br><span class="line">​           "type": "Polygon",</span><br><span class="line">​           "coordinates": [</span><br><span class="line">​             [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0],</span><br><span class="line">​               [100.0, 1.0], [100.0, 0.0] ]</span><br><span class="line">​             ]</span><br><span class="line">​         &#125;,</span><br><span class="line">​         "properties": &#123;</span><br><span class="line">​           "prop0": "value0",</span><br><span class="line">​           "prop1": &#123;"this": "that"&#125;</span><br><span class="line">​           &#125;</span><br><span class="line">​         &#125;</span><br><span class="line">​       ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h5><p>github-demo <font color="gray" size="4"><a href="https://github.com/SmNiuhe/geotools/" target="_blank" rel="noopener">传送门</a></font></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">smniuhe</p>
              <div class="site-description motion-element" itemprop="description">大家好，我是牛河</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">49</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">33</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">70</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/SmNiuhe" title="GitHub &rarr; https://github.com/SmNiuhe" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:smniuhe@gmail.com" title="E-Mail &rarr; mailto:smniuhe@gmail.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://jm.taobao.org" title="http://jm.taobao.org" rel="noopener" target="_blank">阿里中间件</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://tech.meituan.com" title="https://tech.meituan.com" rel="noopener" target="_blank">美团技术团队</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mercyblitz.github.io" title="https://mercyblitz.github.io" rel="noopener" target="_blank">Mercy Ma</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://coolshell.cn" title="https://coolshell.cn" rel="noopener" target="_blank">CoolShell</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.yinwang.org" title="http://www.yinwang.org" rel="noopener" target="_blank">当然我在扯淡</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.itmuch.com" title="http://www.itmuch.com" rel="noopener" target="_blank">周立</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.iocoder.cn" title="http://www.iocoder.cn" rel="noopener" target="_blank">芋道源码</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.didispace.com" title="http://blog.didispace.com" rel="noopener" target="_blank">程序猿DD</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.720ui.com" title="http://blog.720ui.com" rel="noopener" target="_blank">梁桂钊</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ityouknow.com" title="http://www.ityouknow.com" rel="noopener" target="_blank">纯洁的微笑</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">smniuhe</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.1</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.1"></script>



  

  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  



  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
